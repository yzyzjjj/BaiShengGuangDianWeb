function pageReady(){_permissionList[179]={uIds:["showAddModel"]};_permissionList[180]={uIds:[]};_permissionList[181]={uIds:[]};_permissionList=checkPermissionUi(_permissionList);getDeviceModelList()}function getDeviceModelList(){ajaxPost("/Relay/Post",{opType:120},function(n){if(n.errno!=0){layer.msg(n.errmsg);return}var t=_permissionList[180].have,i=_permissionList[181].have,r=function(n,t,i,r){return r.row+1},u=function(n,t,i){return i.Description=i.Description?i.Description:"",i.Description.length>tdShowContentLength?i.Description.substr(0,tdShowContentLength)+'<a href = "javascript:showDescriptionModel({0})">...<\/a> '.format(i.Id):i.Description},f=function(n){var r="<li><a onclick=\"showUpdateModel({0}, '{1}', '{2}', '{3}')\">修改<\/a><\/li>".format(n.Id,n.DeviceCategoryId,escape(n.ModelName),escape(n.Description)),u="<li><a onclick=\"deleteDeviceModel({0}, '{1}')\">删除<\/a><\/li>".format(n.Id,escape(n.ModelName));return'<div class="btn-group"><button type = "button" class="btn btn-default" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-asterisk"><\/i>操作<\/button >    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">        <span class="caret"><\/span>        <span class="sr-only">Toggle Dropdown<\/span>    <\/button>    <ul class="dropdown-menu" role="menu" style="cursor:pointer">{0}{1}    <\/ul><\/div>'.format(t?r:"",i?u:"")},e=t||i?[{data:null,title:"序号",render:r},{data:"Id",title:"Id",bVisible:!1},{data:"ModelName",title:"设备型号"},{data:"CategoryName",title:"设备类型"},{data:"Description",title:"备注",render:u},{data:null,title:"操作",render:f,orderable:!1}]:[{data:null,title:"序号",render:r},{data:"Id",title:"Id",bVisible:!1},{data:"ModelName",title:"设备型号"},{data:"CategoryName",title:"设备类型"},{data:"Description",title:"备注",render:u}];$("#deviceModelList").DataTable({dom:'<"pull-left"l><"pull-right"f>rt<"col-sm-5"i><"col-sm-7"p>',destroy:!0,paging:!0,searching:!0,language:oLanguage,data:n.datas,aLengthMenu:[20,40,60],iDisplayLength:20,columns:e})})}function showDescriptionModel(n){var t={};t.opType=120;t.opData=JSON.stringify({id:n});ajaxPost("/Relay/Post",t,function(n){if(n.errno!=0){layer.msg(n.errmsg);return}n.datas.length>0&&$("#description").html(n.datas[0].Description);$("#descriptionModel").modal("show")})}function showAddModel(){$("#addModelName").val("");$("#addDesc").val("");hideTip($("#addModelNameTip"));var n={};n.opType=140;ajaxPost("/Relay/Post",n,function(n){var r,t,i;if(n.errno!=0){layer.msg(n.errmsg);return}for($("#addSelect").empty(),r='<option value="{0}">{1}<\/option>',t=0;t<n.datas.length;t++)i=n.datas[t],$("#addSelect").append(r.format(i.Id,i.CategoryName));$("#addModel").modal("show")})}function addModel(){var r=$("#addSelect").val(),n=$("#addModelName").val().trim(),t,i;if(isStrEmptyOrUndefined(n)){showTip($("#addModelNameTip"),"型号不能为空");return}t=$("#addDesc").val();i=function(){$("#addModel").modal("hide");var i={};i.opType=123;i.opData=JSON.stringify({DeviceCategoryId:r,ModelName:n,Description:t});ajaxPost("/Relay/Post",i,function(n){layer.msg(n.errmsg);n.errno==0&&getDeviceModelList()})};showConfirm("添加",i)}function deleteDeviceModel(n,t){t=unescape(t);var i=function(){var t={};t.opType=124;t.opData=JSON.stringify({id:n});ajaxPost("/Relay/Post",t,function(n){layer.msg(n.errmsg);n.errno==0&&getDeviceModelList()})};showConfirm("删除设备型号："+t,i)}function showUpdateModel(n,t,i,r){i=unescape(i);r=unescape(r);var u={};u.opType=140;ajaxPost("/Relay/Post",u,function(u){var o,f,e;if(u.errno!=0){layer.msg(u.errmsg);return}for($("#updateSelect").empty(),o='<option value="{0}">{1}<\/option>',f=0;f<u.datas.length;f++)e=u.datas[f],$("#updateSelect").append(o.format(e.Id,e.CategoryName));hideTip($("#updateModelNameTip"));$("#updateId").html(n);$("#updateSelect").val(t);$("#updateModelName").val(i);$("#updateDesc").val(r);$("#updateModel").modal("show")})}function updateModel(){var r=parseInt($("#updateId").html()),u=$("#updateSelect").val(),n=$("#updateModelName").val().trim(),t,i;if(isStrEmptyOrUndefined(n)){showTip($("#updateModelNameTip"),"型号不能为空");return}t=$("#updateDesc").val();i=function(){$("#updateModel").modal("hide");var i={};i.opType=122;i.opData=JSON.stringify({id:r,DeviceCategoryId:u,ModelName:n,Description:t});ajaxPost("/Relay/Post",i,function(n){layer.msg(n.errmsg);n.errno==0&&getDeviceModelList()})};showConfirm("修改",i)}var _permissionList=[];