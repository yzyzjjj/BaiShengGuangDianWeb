function pageReady(){getApplicationList();checkPermission(148)||$("#showAddApplication").addClass("hidden")}function getApplicationList(){var n=145;if(!checkPermission(n)){layer.msg("没有权限");return}ajaxPost("/Relay/Post",{opType:n},function(n){if(n.errno!=0){layer.msg(n.errmsg);return}var r=0,t=function(){return++r},u=checkPermission(147)||checkPermission(149)?[{data:null,title:"序号",render:t},{data:"Id",title:"Id",bVisible:!1},{data:"ApplicationName",title:"名称"},{data:"FilePath",title:"程序文件的位置及名称"},{data:"Description",title:"描述"},{data:null,title:"操作",render:op}]:[{data:null,title:"序号",render:t},{data:"Id",title:"Id",bVisible:!1},{data:"ApplicationName",title:"名称"},{data:"FilePath",title:"程序文件的位置及名称"},{data:"Description",title:"描述"}],i=function(n,t,i){return i.Description=i.Description?i.Description:"",i.Description.length>tdShowContentLength?i.Description.substr(0,tdShowContentLength)+'<a href = "javascript:showDescriptionModel({0})">...<\/a> '.format(i.Id):i.Description},f=checkPermission(147)||checkPermission(149)?[{orderable:!1,targets:5},{targets:[4],render:i}]:[{targets:[4],render:i}];$("#applicationList").DataTable({destroy:!0,paging:!0,searching:!0,language:oLanguage,data:n.datas,aLengthMenu:[20,40,60],iDisplayLength:20,columns:u,columnDefs:f})})}function showFilePathModel(n){var i=145,t;if(!checkPermission(i)){layer.msg("没有权限");return}t={};t.opType=i;t.opData=JSON.stringify({id:n});ajaxPost("/Relay/Post",t,function(n){if(n.errno!=0){layer.msg(n.errmsg);return}n.datas.length>0&&$("#filePath").html(n.datas[0].FilePath);$("#filePathModel").modal("show")})}function showDescriptionModel(n){var i=145,t;if(!checkPermission(i)){layer.msg("没有权限");return}t={};t.opType=i;t.opData=JSON.stringify({id:n});ajaxPost("/Relay/Post",t,function(n){if(n.errno!=0){layer.msg(n.errmsg);return}n.datas.length>0&&$("#description").html(n.datas[0].Description);$("#descriptionModel").modal("show")})}function showAddApplication(){hideClassTip("adt");$("#addApplicationName").val("");$("#addFilePath").val("");$("#addDesc").val("");$("#addModel").modal("show")}function addApplication(){var n=148,r;if(!checkPermission(n)){layer.msg("没有权限");return}var t=$("#addApplicationName").val().trim(),i=$("#addFilePath").val().trim(),u=$("#addDesc").val();if(isStrEmptyOrUndefined(t)){showTip($("#addApplicationNameTip"),"名称不能为空");return}if(isStrEmptyOrUndefined(i)){showTip($("#addFilePathTip"),"程序文件不能为空");return}r=function(){$("#addModel").modal("hide");var r={};r.opType=n;r.opData=JSON.stringify({ApplicationName:t,FilePath:i,Description:u});ajaxPost("/Relay/Post",r,function(n){layer.msg(n.errmsg);n.errno==0&&getApplicationList()})};showConfirm("添加",r)}function deleteApplication(n,t){var i,r;if(t=unescape(t),i=149,!checkPermission(i)){layer.msg("没有权限");return}r=function(){var t={};t.opType=i;t.opData=JSON.stringify({id:n});ajaxPost("/Relay/Post",t,function(n){layer.msg(n.errmsg);n.errno==0&&getApplicationList()})};showConfirm("删除应用层："+t,r)}function showUpdateApplication(n,t,i,r){t=unescape(t);i=unescape(i);r=unescape(r);hideClassTip("adt");$("#updateId").html(n);$("#updateApplicationName").val(t);$("#updateFilePath").val(i);$("#updateDesc").val(r);$("#updateApplicationModal").modal("show")}function updateApplication(){var n=147,r;if(!checkPermission(n)){layer.msg("没有权限");return}var u=parseInt($("#updateId").html()),t=$("#updateApplicationName").val().trim(),i=$("#updateFilePath").val().trim(),f=$("#updateDesc").val();if(isStrEmptyOrUndefined(t)){showTip($("#updateApplicationNameTip"),"名称不能为空");return}if(isStrEmptyOrUndefined(i)){showTip($("#updateFilePathTip"),"程序文件不能为空");return}r=function(){$("#updateApplicationModal").modal("hide");var r={};r.opType=n;r.opData=JSON.stringify({id:u,ApplicationName:t,FilePath:i,Description:f});ajaxPost("/Relay/Post",r,function(n){layer.msg(n.errmsg);n.errno==0&&getApplicationList()})};showConfirm("修改",r)}var op=function(n){var t="<li><a onclick=\"showUpdateApplication({0}, '{1}', '{2}', '{3}')\">修改<\/a><\/li>".format(n.Id,escape(n.ApplicationName),escape(n.FilePath),escape(n.Description)),i="<li><a onclick=\"deleteApplication({0}, '{1}')\">删除<\/a><\/li>".format(n.Id,escape(n.ApplicationName));return'<div class="btn-group"><button type = "button" class="btn btn-default" data-toggle="dropdown" aria-expanded="false"> <i class="fa fa-asterisk"><\/i>操作<\/button >    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">        <span class="caret"><\/span>        <span class="sr-only">Toggle Dropdown<\/span>    <\/button>    <ul class="dropdown-menu" role="menu" style="cursor:pointer">{0}{1}    <\/ul><\/div>'.format(checkPermission(147)?t:"",checkPermission(149)?i:"")};