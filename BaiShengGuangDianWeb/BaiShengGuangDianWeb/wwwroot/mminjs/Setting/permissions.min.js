function pageReady(){getPermissionsList();checkPermission(81)||$("#delPermission").addClass("hidden")}function getPermissionsList(){delList=[];$("#permissionsList").empty();ajaxGet("/Account/Permissions",null,function(n){if(n.errno!=0){layer.msg(n.errmsg);return}var i=function(n){return'<input type="checkbox" value="{0},{1}" name="chkItem" class="icb_minimal" onclick="">'.format(n.id,n.name)},r=0,t=function(){return++r},u=checkPermission(81)?[{data:null,title:"请选择",render:i},{data:null,title:"序号",render:t},{data:"name",title:"Name"},{data:"isPage",title:"IsPage"},{data:"type",title:"Type"},{data:"label",title:"Label"}]:[{data:null,title:"序号",render:t},{data:"name",title:"Name"},{data:"isPage",title:"IsPage"},{data:"type",title:"Type"},{data:"label",title:"Label"}],f=checkPermission(81)?[[1,"asc"]]:[[0,"asc"]],e=checkPermission(81)?[{orderable:!1,targets:0}]:"";$("#permissionsList").DataTable({destroy:!0,paging:!0,searching:!0,language:{url:"/content/datatables_language.json"},data:n.datas,aaSorting:f,aLengthMenu:[15,30,60],iDisplayLength:15,columns:u,columnDefs:e,drawCallback:function(){$("#permissionsList .icb_minimal").iCheck({handle:"checkbox",checkboxClass:"icheckbox_minimal-red",radioClass:"iradio_minimal-red",increaseArea:"20%"});$("#permissionsList .icb_minimal").on("ifChanged",function(){var n=$(this),t=n.attr("value");n.is(":checked")?delList.push(t):(n.parents("tr:first").hasClass("odd"),delList.splice(delList.indexOf(t),1))})}})})}function delPermission(){for(var f=delList.join(),t=f.split(","),i=[],r=[],n=0;n<t.length;n++)n%2==0?i.push(t[n]):r.push(t[n].trim());var u=i.join(","),e=r.join("<br>"),o=function(){var n={};n.permission=u;ajaxPost("/Account/DeletePermission",n,function(n){layer.msg(n.errmsg);n.errno==0&&getPermissionsList()})};isStrEmptyOrUndefined(u)?layer.msg("请选择要删除的数据"):showConfirm("删除以下权限:<pre style='color:red'>"+e+"<\/pre>",o)}var delList=null;