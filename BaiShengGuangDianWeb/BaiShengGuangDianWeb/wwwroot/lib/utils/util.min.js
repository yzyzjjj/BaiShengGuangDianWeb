function isPhone(n){return isNaN(n)?!1:/^[1][3,4,5,7,8,9][0-9]{9}$/g.test(n)}function isEmail(n){return/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(n)?!0:!1}function isStrEmptyOrUndefined(n){return n==""?!0:n==undefined?!0:!1}function isMac(n){return/^[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}:[A-Fa-f\d]{2}$/.test(n)||/^[A-Fa-f\d]{2}-[A-Fa-f\d]{2}-[A-Fa-f\d]{2}-[A-Fa-f\d]{2}-[A-Fa-f\d]{2}-[A-Fa-f\d]{2}$/.test(n)?!0:!1}function isIp(n){var t=n.match(/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/);return t==null?!1:!0}function isPort(n){return n<0||n>65536?!1:!0}function isNumber(n){if(n===undefined||n===null||n==="")return!1;if(typeof n=="string")return/^\d+$/.test(n)||/^-\d+$/.test(n)||/^[1-9]\d*[.]\d+$/.test(n)||/^0[.]\d+$/.test(n)||/^-[1-9]\d*[.]\d+$/.test(n)||/^-0[.]\d+$/.test(n)?!0:!1;return typeof n=="number"?!0:!1}function getJwtInfo(n){if(isStrEmptyOrUndefined(n))return null;var r=n.split("."),u=r[1],f=Base64.decode(u),t=JSON.parse(f),i=GetCookie("per");return t.permissionsList=isStrEmptyOrUndefined(i)?[]:i.split(",").map(Number),t.proleList=isStrEmptyOrUndefined(t.prole)?[]:t.prole.split(",").map(Number),t}function getCookieTokenInfo(){var n=GetCookie("token");return getJwtInfo(n)}function isTokenValid(){var n=getCookieTokenInfo(),t;return n==null?!1:(t=(new Date).getTime()/1e3,t>n.exp)?!1:!0}function checkPermission(n){var t=getCookieTokenInfo();return t!=null&&isTokenValid()?t.permissionsList.indexOf(n)>=0:(window.location.href=loginUrl,-1)}function checkPermissionUi(n){var r,u,t,i;for(r in n)if(n.hasOwnProperty(r)&&isNumber(r))if(u=parseInt(r),t=n[u],t.have=checkPermission(u),t.have)for(i in t.uIds)t.uIds.hasOwnProperty(i)&&$(`#${t.uIds[i]}`).removeClass("hidden");else for(i in t.uIds)t.uIds.hasOwnProperty(i)&&$(`#${t.uIds[i]}`).addClass("hidden");return n}function addCover(){$("body").append('<div id="body-cover"><div class="spinner"> <div class="spinner-container container1"><div class="circle1"><\/div><div class="circle2"><\/div> <div class="circle3"><\/div><div class="circle4"><\/div>  <\/div> <div class="spinner-container container2"><div class="circle1"><\/div> <div class="circle2"><\/div><div class="circle3"><\/div> <div class="circle4"><\/div> <\/div><div class="spinner-container container3"><div class="circle1"><\/div> <div class="circle2"><\/div>  <div class="circle3"><\/div> <div class="circle4"><\/div><\/div><\/div><\/div>')}function removeCover(){$("#body-cover").remove()}function reLogin(){console.log("err");window.location.href=loginUrl}function ajaxPost(n,t,i,r){r!=0&&addCover();t==null&&(t={});var u=function(n){if(n==loginUrl){reLogin();return}r!=0&&removeCover();i(n)};$.post(n,t,u).error(reLogin)}function ajaxGet(n,t,i){var r,u,f;t==null&&(t={});r="";for(u in t)r==""&&(r="?"),r!="?"&&(r=r+"&"),r=r+u+"="+t[u];f=function(n){if(n==loginUrl){reLogin();return}removeCover();i(n)};n=n+r;$.get(n,f).error(reLogin)}function addToken(n){var t=GetCookie("token");return isStrEmptyOrUndefined(t)||(n.token=t),n}function getTokenTable(){var n=GetCookie("token");return isStrEmptyOrUndefined(n)?{}:{token:n}}function errorHandle(n){return n.errno==undefined||n.errno==null?!1:n.errno==0?!1:(layer.alert(n.errmsg),!0)}function SetCookie(n,t){var i=new Date;i.setTime(i.getTime()+31104e6);document.cookie=n+"="+escape(t)+";expires="+i.toGMTString()}function GetCookie(n){var t=document.cookie.match(new RegExp("(^| )"+n+"=([^;]*)(;|$)"));return t!=null?unescape(t[2]):null}function DelCookie(n){var t=new Date,i;t.setTime(t.getTime()-1);i=GetCookie(n);i!=null&&(document.cookie=n+"="+i+"; path=/;expires="+t.toGMTString())}function uploaderImg(n,t,i){function o(n){var t,i;for(t in uploader.fileList)for(i in uploader.fileList[t])if(uploader.fileList[t][i]===n)return t}function s(n){var t=o(File);for(var i in uploader.fileList[t])if(uploader.fileList[t][i]===n)return i}var r={},e,u,f;for(e in n)r[e]=n[e];$(document.body).append($('<input id="hidden-uploader-btn" type="file" style="display:none"  hidden/>'));for(e in n)(function(t){var i=$('<input type="file" accept="image/*" style="display:none"  hidden/>').change(function(){var r=$(n[t])[0],i=this.files[0];i&&(u=t,f=n[t],uploader.addFile(i))});$(document.body).append(i);$(n[t]).click(function(){i.click()})})(e);return uploader=new plupload.Uploader({browse_button:"hidden-uploader-btn",filters:{mime_types:[{title:"Image files",extensions:"jpeg,jpg,png"},],max_file_size:"10mb"},resize:{width:2500,quality:92,crop:!1,preserve_headers:!0},init:{PostInit:function(){},FilesAdded:function(n,t){var r=t[0],e;u&&f?(uploader.fileList[u]||(uploader.fileList[u]={}),uploader.fileList[u][f]&&uploader.removeFile(uploader.fileList[u][f]),uploader.fileList[u][f]=r,e=new FileReader,e.readAsDataURL(r.getNative()),e.onload=function(n){$(f).css("background-image","url("+n.target.result+")").addClass("bx-sz-img-loaded");i&&i.fileAdded&&i.fileAdded($(f)[0].id,r.getNative(),n.target.result)}):uploader.removeFile(r)},BeforeUpload:function(n,t){var f=o(t),r,i,u,e;if(f){if(r=uploader.fileAuths[f],r instanceof Array){for(u=0;u<r.length;u++)if(!r[u].used){i=r[u];uploader.fileAuths[f][u].used=!0;break}}else i=r;i?(e={key:i.objname,OSSAccessKeyId:i.accessid,policy:i.policy,signature:i.signature,callback:i.callback,success_action_status:"200"},n.setOption({url:i.host,multipart_params:e}),n._start()):n.removeFile(t)}else n.removeFile(t)},FileUploaded:function(n,r,u){var e,h,f;if(u.status===200){e=o(r);e;try{h=JSON.parse(u.response);t&&t(h)}catch(c){}}else i&&i.uploadedError?i.uploadedError(n,r,u):(f=s(r),f&&($(f).css("background-image","none"),$(f).removeClass("bx-sz-img-loaded"),layer.msg("上传失败,请重新上传",{icon:2})))},Error:function(n,t){if(t.file){var r=s(t.file);r&&($(r).css("background-image","none"),$(r).removeClass("bx-sz-img-loaded"));switch(t.code){case plupload.FILE_SIZE_ERROR:layer.msg("文件大小超出上传上限",{icon:2});break;case plupload.FILE_EXTENSION_ERROR:layer.msg("文件格式错误",{icon:2});break;case plupload.FILE_DUPLICATE_ERROR:layer.msg("不能上传同一张图片",{icon:2});break;case plupload.IMAGE_FORMAT_ERROR:layer.msg("图片格式出错",{icon:2});break;default:layer.msg("请重新上传",{icon:2})}}else layer.msg("上传失败,请重新上传..",{icon:2});i&&i.error&&i.error(n,t)}}}),uploader.fileList={},uploader.fileAuths={},uploader.init(),uploader._start=uploader.start,uploader.start=function(n){uploader.fileAuths=n;uploader._start()},uploader.addImg=function(n,t){var e,i;r[t]instanceof Array?r[t].push(n):(e=r[t],r[t]=[e,n]);i=$('<input type="file" accept="image/*" style="display:none" hidden/>').change(function(){var i=this.files[0];i&&(u=t,f=n,uploader.addFile(i))});$(document.body).append(i);$(n).click(function(){i.click()})},uploader.getPictures=function(){var e=[],n,t,f,i,u;for(n in r){if(t={UploadFileType:n,NewCount:0,ModifyList:[]},r[n]instanceof Array)for(f=0;f<r[n].length;f++)i=r[n][f],$(i).hasClass("bx-sz-img-loaded")&&uploader.fileList[n]&&uploader.fileList[n]&&uploader.fileList[n][i]&&(u=parseInt($(i).attr("data-modify-idx")),u===0||u?t.ModifyList.push(u):t.NewCount++);else i=r[n],$(i).hasClass("bx-sz-img-loaded")&&uploader.fileList[n]&&uploader.fileList[n][i]&&(u=parseInt($(i).attr("data-modify-idx")),u===0||u?t.ModifyList.push(u):t.NewCount=1);(t.NewCount>0||t.ModifyList.length>0)&&e.push(t)}return e},uploader.removeAllImgs=function(){r={};uploader.fileList={}},uploader}function CreateImgsByMultyUrl(n,t){var u,r,i,f;if($(n).html(""),t)for(u=t.split(","),r=0;r<u.length;r++)i=document.createElement("img"),i.setAttribute("src",u[r]),i.setAttribute("style","margin-top:5px"),f=new Viewer(i),$(n).append(i),$(n).append("<br />")}function CreateImgsByMultyUrlNew(n,t){var u,i,r;if($(n).html(""),t)for(u=t.split(","),i=0;i<u.length;i++)r=document.createElement("img"),r.setAttribute("src",u[i]),r.setAttribute("style","margin-top:5px"),$(n).append(r),$(n).append("<br />")}function CreateInvoiceImgs(n,t){var i,f,r,u,e;if($(n).html(""),t)for(i=0;i<t.OurInvoiceUrlList.length;i++)f=t.OurInvoiceUrlList[i].m_Item2.URL,r=document.createElement("imgDiv"),$(r).append('<h4 style="color:#45B4FF; margin-top:5px;">第'+t.OurInvoiceUrlList[i].m_Item1+"期<\/h4>"),$(r).append('<p style="margin-top:5px;"><b style="margin-right:10px;">发票号:<\/b>'+t.OurInvoiceUrlList[i].m_Item2.Id+"<\/p>"),$(r).append('<p style="margin-top:5px;"><b style="margin-right:10px;">开票时间:<\/b>'+t.OurInvoiceUrlList[i].m_Item2.Time+"<\/p>"),u=document.createElement("img"),u.setAttribute("src",f),e=new Viewer(u),$(r).append(u),$(n).append(r)}function CreateInvoiceImgsNew(n,t){var i,f,r,u;if($(n).html(""),t)for(i=0;i<t.OurInvoiceUrlList.length;i++)f=t.OurInvoiceUrlList[i].m_Item2.URL,r=document.createElement("imgDiv"),$(r).append('<h4 style="color:#45B4FF; margin-top:5px;">第'+t.OurInvoiceUrlList[i].m_Item1+"期<\/h4>"),$(r).append('<p style="margin-top:5px;"><b style="margin-right:10px;">发票号:<\/b>'+t.OurInvoiceUrlList[i].m_Item2.Id+"<\/p>"),$(r).append('<p style="margin-top:5px;"><b style="margin-right:10px;">开票时间:<\/b>'+t.OurInvoiceUrlList[i].m_Item2.Time+"<\/p>"),u=document.createElement("img"),u.setAttribute("src",f),$(r).append(u),$(n).append(r)}function ImgCreated(n){this.id=n.id;this.url=n.url;this.dataType();this.create()}function dataType(){var n=Object.prototype.toString,t={isStr:function(t){return n.call(t)=="[object String]"},isObj:function(t){return n.call(t)=="[object Object]"},isArr:function(t){return n.call(t)=="[object Array]"},isNull:function(t){return n.call(t)=="[object Null]"}};if(!t.isArr(this.id))throw"ID  type must be an array";if(!t.isArr(this.url))throw"URL  type must be an array";if(this.id.length!==this.url.length)throw"The length of ID and URL must be the same";}function imgShowBig(n){var t=new Viewer(document.getElementById(n),{ready:function(){t.update()},show:function(){t.update()},shown:function(){t.update()},hide:function(){t.update()}})}function create(){var n=this,t=[null,undefined,NaN];this.url.forEach(function(i,r){var u=document.getElementById(n.id[r]);if(u.innerHTML="",t.indexOf(i)>=0)return!1;i.split(",").forEach(function(n){var t=document.createElement("img");t.className="idePhoto";t.setAttribute("src",n);u.appendChild(t)})})}function showConfirm(n,t){layer.confirm("是否确定"+n,{btn:["确定","取消"],success:function(){this.enterEsc=function(n){return n.keyCode===13?($(".layui-layer-btn0").click(),!1):n.keyCode==27?($(".layui-layer-btn1").click(),!1):void 0};$(document).on("keydown",this.enterEsc)},end:function(){$(document).off("keydown",this.enterEsc)}},function(n){layer.close(n);t()},function(n){layer.close(n)})}function focusIn(n,t="label-danger"){var i=n.parent().find("."+t+":first");i.html();i.addClass("hidden")}function inputChange(n,t){var i=n.parents("."+t+":first").find(".label-danger");i.html();i.addClass("hidden")}function hideTip(n){typeof n=="string"?($("#"+n).addClass("hidden"),$("#"+n).html()):(n.addClass("hidden"),n.html())}function showTip(n,t){typeof n=="string"?($("#"+n).removeClass("hidden"),$("#"+n).html(t)):(n.removeClass("hidden"),n.html(t))}function hideClassTip(n){$("."+n).addClass("hidden");$("."+n).html()}function showClassTip(n,t){$("."+n).removeClass("hidden");$("."+n).html(t)}function getQueryString(n){var i=new RegExp("(^|&)"+n+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(i);return t!=null?unescape(t[2]):null}function getFilePath(n,t=undefined,i=1){ajaxPost(filePathUrl,n,n=>{const i=n.errmsg;if(n.errno==0)t!=undefined&&(n.data.forEach(n=>{n.path=fileUrl+n.path}),t(n.data));else return layer.msg(i)},i)}function getFilePathAsync(n,t=undefined,i=1){return new Promise(r=>{ajaxPost(filePathUrl,n,n=>{const i=n.errmsg;if(n.errno==0)t!=undefined&&(n.data.forEach(n=>{n.path=fileUrl+n.path}),t(n.data)),r(n);else return layer.msg(i)},i)})}function initFileInput(n,t){$("#"+n).attr("accept",fileAccept[t]);return $("#"+n).fileinput({language:"zh",uploadUrl:fileUploadUrl+"/File",allowedFileExtensions:fileExt[t],showUpload:!1,showPreview:!0,showCaption:!0,minFileCount:1,maxFileCount:1,dropZoneEnabled:!1,browseClass:"btn btn-primary",uploadAsync:!0,autoReplace:!0,layoutTemplates:{actionDelete:"",actionUpload:"",actionZoom:""},uploadExtraData:function(){var n={},i;n.type=t;n.dir="";for(i in fileEnum)if(fileEnum[i]==t){n.dir=i;break}return n.typeStr=t,n}}).on("filebatchselected",function(i,r){var u,f;r.length>1&&$("#"+n).fileinput("clear");switch(t){case fileEnum.FirmwareLibrary:case fileEnum.ApplicationLibrary:r.length!=undefined&&$("#"+n).fileinput("clear");u="";for(f in r)if(r.hasOwnProperty(f)){u=f;break}checkFileExt(u,fileExt[t])||$("#"+n).fileinput("clear")}}).on("filepreupload",function(n,t){var i=t.form,r=t.files,u=t.extra,f=t.response,e=t.reader;console.log("文件正在上传")}).on("fileerror",function(n,t,i){console.log("文件上传失败！"+i);$(this).fileinput("clear")}).on("fileuploaded",function(n,i){console.log(`文件上传${i.response.errmsg}！`);$(this).fileinput("clear");fileCallBack[t](i.response)})}function initFileInputMultiple(n,t){prepareUpload=[];$("#"+n).attr("multiple","");$("#"+n).attr("accept",fileAccept[t]);return $("#"+n).fileinput({language:"zh",uploadUrl:fileUploadUrl+"/FileMultiple",allowedFileExtensions:fileExt[t],showUpload:!1,showPreview:!0,showCaption:!0,minFileCount:0,maxFileCount:0,dropZoneEnabled:!1,browseClass:"btn btn-primary",uploadAsync:!0,autoReplace:!1,layoutTemplates:{actionUpload:""},uploadExtraData:function(){var n={},i;n.type=t;n.dir="";for(i in fileEnum)if(fileEnum[i]==t){n.dir=i;break}return n}}).on("filebatchselected",function(i,r){var u="",e,f;for(e in r)if(r.hasOwnProperty(e)){if(u=e,!checkFileExt(u,fileExt[t])){$("#"+n).fileinput("clear");break}f=$("#"+$(this).attr("parent")).find('[data-fileid="{0}"]'.format(u)).filter(".file-preview-frame").first().attr("id");prepareUpload[f]||(prepareUpload[f]={pre:f,name:u,done:!1})}}).on("fileclear",function(){prepareUpload=[]}).on("fileremoved",function(n,t){console.log("删除选择文件");prepareUpload=removeArrayObj(prepareUpload,t)}).on("filepreupload",function(n,t){console.log("文件正在上传");var i=t.form,r=t.files,u=t.extra,f=t.response,e=t.reader}).on("fileerror",function(n,i,r){console.log("文件上传失败！"+r);$(this).fileinput("clear");fileCallBack[t]({errno:1,errmsg:"失败"})}).on("fileuploaded",function(n,t,i){var r=t.response,u,f;if(r.errno==0)for(console.log("文件上传成功！"),u=0;u<r.data.length;u++)f=r.data[u],prepareUpload[i].done=!0,prepareUpload[i].newName=f.newName;else console.log("文件上传失败！"),layer.msg(r.errmsg)}).on("filebatchuploadcomplete",function(){var n,i;console.log("文件全部上传成功！");n=!0;for(i in prepareUpload)prepareUpload.hasOwnProperty(i)&&(prepareUpload[i].done||(n=!1));n?fileCallBack[t]({errno:0,errmsg:"成功",data:prepareUpload}):fileCallBack[t]({errno:1,errmsg:"失败"});prepareUpload=[]})}function hasPre(){var n=!1;for(var t in prepareUpload)prepareUpload.hasOwnProperty(t)&&(n=!0);return n}function checkFileExt(n,t){var r=n.toLowerCase().split("."),i;if(r.length>1)for(i=0;i<t.length;i++)if(r[r.length-1]==t[i])return!0;return!1}function onTimeLimitInput(n,t=59,i=5){n.value=input(n.value,i,0);n.value=n.value<0?0:n.value;n.value=n.value>t?t:n.value}function onInput(n,t=5,i=4,r=undefined,u=undefined){var f="";n.value?f=n.value:$(n).val()?f=$(n).val():$(n).text()&&(f=$(n).text());f=input(f,t,i);r&&parseFloat(f)<r&&(f=r);u&&parseFloat(f)>u&&(f=u);n.value?n.value=f:$(n).val()?$(n).val(f):$(n).text()&&$(n).text(f)}function input(n,t=5,i=4){n!=""&&n.substr(0,1)=="."&&(n="");n=n.replace(/^0*(0\.|[1-9])/,"$1");n=n.replace(/[^\d.]/g,"");n=n.replace(/\.{2,}/g,".");n=n.replace(".","$#$").replace(/\./g,"").replace("$#$",".");var r=eval("/^(\\-)*(\\d+)\\.(\\d{"+i+"}).*$/");if(n=n.replace(r,"$1$2.$3"),n.indexOf(".")<0&&n!="")while(n.substr(0,2)=="00")n=n.substr(1,n.length);return n!=""&&(n=n.split("."),n.length>0&&n[0].length>=t&&(n[0]=n[0].substr(0,t)),n.length>0&&n[1]&&n[1].length>=i&&(n[1]=n[1].substr(0,i)),n=i>0?n.join("."):n.join("")),isStrEmptyOrUndefined(n)&&(n="0"),n}function onInputEnd(n){n.value=inputEnd(n.value)}function inputEnd(n){if(n.indexOf(".")>-1&&n!=""){for(n=n.split("").reverse().join("");n.substr(0,1)=="0";)n=n.substr(1,n.length);while(n.substr(0,1)==".")n=n.substr(1,n.length);return n.split("").reverse().join("")}return n}function onInputDouHao(n){var t="";n.value?t=n.value:$(n).val()?t=$(n).val():$(n).text()&&(t=$(n).text());t=inputDouHao(t);n.value?n.value=t:$(n).val()?$(n).val(t):$(n).text()&&$(n).text(t)}function inputDouHao(n){for(n!=""&&n.substr(0,1)==","&&(n="");n!=""&&n[n.length-1]==",";)n=n.substr(0,n.length-1);for(n=n.replace(/^0*(0\.|[1-9])/,"$1"),n=n.replace(/[^\d,]/g,""),n=n.replace(".","$#$").replace(/\./g,"").replace("$#$",".");n!=""&&n[n.length-1]==",";)n=n.substr(0,n.length-1);return isStrEmptyOrUndefined(n)&&(n=""),n}function autoCal(n,t){var o,i,u,e,f,r;if(n.value!=""){for(o=0,n.value.indexOf("±")>-1?o=1:n.value.indexOf("+")>-1&&n.value.indexOf("/")>-1&&n.value.indexOf("-")>-1?o=3:(n.value.indexOf("～")>-1||n.value.indexOf("~")>-1||n.value.indexOf("-")>-1)&&(o=2),t=$("#"+t),i=[],u=n.value.replace(" ","").split(""),u.push(";"),e="",f=0;f<u.length;f++)o==3?isNumber(u[f])||u[f]=="."||u[f]=="-"?e+=u[f]:(isNumber(e)&&(i[i.length]=parseFloat(e)),e=""):isNumber(u[f])||u[f]=="."?e+=u[f]:(isNumber(e)&&(i[i.length]=parseFloat(e)),e="");switch(o){case 1:i.length>=1&&(r=i[0]);break;case 2:i.length==1?r=i[0]:i.length>=2&&(r=(i[0]+i[1])/2);break;case 3:i.length==1?r=i[0]:i.length>=3&&(r=i[0]+(i[1]+i[2])/2);break;default:r=i.length>=1?i[0]:0}r=r.toFixed(4);r=input(r.toString());r=inputEnd(r.toString());t.val(r)}}function pcAndroid(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}function SortNumberString(n,t){return n.sort(function(n,i){return n[t].localeCompare(i[t],"zh-CN",{numeric:!0})})}function objectSort(n,t){for(var i,f,e=n.length,u,r=0;r<e-1;r++){for(u=!0,i=0;i<e-1-r;i++)n[i][t]>n[i+1][t]&&(u=!1,f=n[i],n[i]=n[i+1],n[i+1]=f);if(u)break}}function distinct(n){for(var r=[],u={},f=n.length,i,t=0;t<f;t++)i=n[t],u[i]||(r.push(i),u[i]=1);return r}function removeArray(n,t,i=false){for(var r in n)if(r.hasOwnProperty(t)){n.splice(n.indexOf(r),i?n.length:1);break}return n}function removeArray(n,t,i,r=false){for(var u=n.length-1;u>=0;u--)if(n[u][t]==i){n.splice(n.indexOf(n[u]),r?n.length:1);break}return n}function removeArray(n,t,i,r,u,f=false){for(var e=n.length-1;e>=0;e--)if(n[e][t]==i&&n[e][r]==u){n.splice(n.indexOf(n[e]),f?n.length:1);break}return n}function removeArrayObj(n,t,i=false){var u=[];for(var r in n)r!=t&&(u[r]||i||(u[r]=n[r]));return u}function existArray(n,t){for(var i in n)if(n[i]==t)return!0;return!1}function existArrayObj(n,t,i){for(var r in n)if(n[r].hasOwnProperty(t)&&n[r][t]==i)return!0;return!1}function sliceArray(n,t,i=0){return n||(n=[]),n.slice(i,t)}function clone(n){var t,i,u,r;if(typeof n=="object")if(n===null)t=null;else if(n instanceof Array)for(t=[],i=0,u=n.length;i<u;i++)t.push(clone(n[i]));else{t={};for(r in n)t[r]=clone(n[r])}else t=n;return t}function showAllContent(n,t="备注",i=""){n=unescape(n);i==""&&(i="remarkModel");var u=`<div class="modal fade" id="${i}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
               <div class="modal-content">
                   <div class="modal-header">
                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                       <h4 class="modal-title">${t}</h4>
                   </div>
                   <div class="modal-body">
                       <div class="form-group">
                           <textarea class="form-control" disabled="disabled" id="usuallyFaultDetail" style="resize: vertical; height: 200px; overflow-y: scroll;">${n}</textarea>
                       </div>
                   </div>
                   <div class="modal-footer">
                       <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                   </div>
                </div>
           </div>
        </div>`,r=$(u);$(".content").append(r);r.modal("show");r.on("hidden.bs.modal",function(){r.remove()})}function showPrintModal(n){var c=`<div class="modal fade" id="${"_printModal"}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
               <div class="modal-content">
                   <div class="modal-header">
                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                       <h4 class="modal-title"></h4>
                   </div>
                   <div class="modal-body" style="position:relative">
                        <div class="qrcode-box" style="position:absolute;left:50%;transform:translateX(-50%);width:300px;height:300px">
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <video style="width: 100%;height:300px"></video>
                        <canvas class="hidden" width="300" height="300"></canvas>
                   </div>
                   <div class="modal-footer">
                       <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                   </div>
               </div>
           </div>
        </div>`,t=$(c),s,h;$(".content").append(t);var u,i,e=null,f=$("#_printModal video")[0],r=$("#_printModal canvas")[0],o=r.getContext("2d");t.on("hidden.bs.modal",function(){u&&u.stop();i&&clearInterval(i);n(e);t.remove()});$(document).on("visibilitychange",function(){var n=this.visibilityState;n=="hidden"&&t.modal("hide")});s=(n,t,i)=>{navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(n).then(t).catch(i):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(n).then(t).catch(i):navigator.mozGetUserMedia?navigator.mozGetUserMedia(n).then(t).catch(i):navigator.getUserMedia&&navigator.getUserMedia(n).then(t).catch(i)};h=()=>{o.drawImage(f,0,0,300,300),qrcode.decode(r.toDataURL("image/png")),qrcode.callback=n=>{n!="error decoding QR Code"&&(/,/.test(n)?(e=n,clearInterval(i),o.clearRect(0,0,r.width,r.height),t.modal("hide")):alert(n))}};navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia?s({video:{width:500,height:500,facingMode:{exact:"environment"}}},n=>{t.modal("show"),f.srcObject=n,f.play(),u=n.getTracks()[0],i=setInterval(h,500)},()=>{t.modal("hide"),layer.msg("访问用户媒体设备失败")}):(t.modal("hide"),layer.msg("不支持访问用户媒体"))}function getObjectURL(n){var t=null;return window.createObjectURL!=undefined?t=window.createObjectURL(n):window.URL!=undefined?t=window.URL.createObjectURL(n):window.webkitURL!=undefined&&(t=window.webkitURL.createObjectURL(n)),t}function printImgUp(n,t){var i=getObjectURL(t.files[0]);qrcode.decode(i);qrcode.callback=function(t){URL.revokeObjectURL(i);t!="error decoding QR Code"?/,/.test(t)?n(t):(layer.msg("请上传集中控制相关的二维码图片"),n(null)):(layer.msg("识别失败"),n(null))}}function showBigImg(n){var t;n=unescape(n);const u=`<div id="outerDiv" class="hidden" style="position:fixed;top:0;left:0;background:rgba(0,0,0,0.7);z-index:10000;width:100%;height:100%;">
                    <div id="innerDiv" style="position:absolute;">
                        <img id="bigImg" style="border:5px solid #fff;" src="" />
                    </div>
                </div>`;t=$(u);$(".content").append(t);var i="#outerDiv",f="#innerDiv",r="#bigImg";$(r).attr("src",n);$("<img/>").attr("src",n).load(function(){var u=$(window).width(),h=$(window).height(),o=this.width,s=this.height,n,e,t=.8,c,l;s>h*t?(e=h*t,n=e/s*o,n>u*t&&(n=u*t)):o>u*t?(n=u*t,e=n/o*s):(n=o,e=s);$(r).css("width",n);c=(u-n)/2;l=(h-e)/2;$(f).css({top:l,left:c});$(i).removeClass("hidden").fadeIn("fast")});$(i).click(function(){$(this).fadeOut("fast");t.remove()})}function printCode(n,t){var r=navigator.userAgent.toLowerCase(),u,i;~r.indexOf("trident")||~r.indexOf("msie")?alert("请使用google或者360浏览器打印"):(u=$(n).prop("outerHTML"),$("body").append('<iframe id="iframe" class="hidden" name="iframe"><\/iframe>'),i=$("#iframe")[0].contentDocument,i.body.innerHTML=u,t&&(i.getElementById(t).style.display="none"),window.frames.iframe.print(),$("#iframe").remove())}function printCode(n){var t=navigator.userAgent.toLowerCase(),i;~t.indexOf("trident")||~t.indexOf("msie")?alert("请使用google或者360浏览器打印"):($("body").append('<iframe id="iframe" class="hidden" name="iframe"><\/iframe>'),i=$("#iframe")[0].contentDocument,i.body.innerHTML=n,window.frames.iframe.print(),$("#iframe").remove())}function comTimeDay(n,t){return compareDate(n,t)?(layer.msg("开始时间不能大于结束时间"),!0):!1}function downLoad(n,t){var i=document.createElement("a");i.download=t;i.href=n;i.click()}function createTag(n){var t=n.term.trim();if(t!="")return{id:`tag${t}`,text:t}}function matcher(n,t){var i,r,e,o,u,f,s;if($.trim(n.term)==="")return t;if(t.children&&t.children.length>0){for(i=$.extend(!0,{},t),r=t.children.length-1;r>=0;r--)e=t.children[r],o=matcher(n,e),o==null&&i.children.splice(r,1);return i.children.length>0?i:matcher(n,i)}return(u="",f=n.term?n.term.toUpperCase().trim():"",t.text.toPinYin!=undefined&&(s=t.text.toPinYin().toUpperCase(),u=s.indexOf(f),u==-1&&(u=t.text.toUpperCase().indexOf(f))),u>-1)?t:null}function fullScreen(n){if($(".fullScreenBtn").toggleClass("show"),n){var t=document.body;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()}else document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.exitFullscreen&&document.exitFullscreen()}function addFakeProgress(){var i=`<div class="alert alert-info alert-dismissible" style="width: 300px; position: fixed; top: 40%; left: 50%;transform: translateX(-50%);z-index:999999" id="progress_wrap">
                <label class="control-label">正在升级中...</label>
                <div class="progress progress-sm active no-margin">
                    <div id="progress_box" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="transition:all 0s">
                        <label style="position: absolute; right: 5px;bottom:5px" id="progress_text"></label>
                    </div>
                </div>
            </div>`,n,t;return $("body").append(i),n=0,t=setInterval(()=>{var i=`${++n}%`;$("#progress_text").text(i);$("#progress_box").css("width",i);n==95&&clearInterval(t)},100),()=>{clearInterval(t),$("#progress_text").text("100%"),$("#progress_box").css("width","100%"),setTimeout(()=>{$("#progress_wrap").remove()},200)}}function toNonExponential(n){n=n||0;var t=n.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return n.toFixed(Math.max(0,(t[1]||"").length-t[2]))}function setOptions(n,t,i=false){return n.reduce((n,r,u)=>`${n}<option value="${r.Id}"${i?` style="color:${optionColors[u>optionColors.length?u%optionColors.length:u]}"`:""}>${r[t]}</option>`,"")}function setOptionsWithKey(n,t,i,r=false){return n.reduce((n,u,f)=>`${n}<option value="${u[t]}"${r?` style="color:${optionColors[f>optionColors.length?f%optionColors.length:f]}"`:""}>${u[i]}</option>`,"")}function convertCurrency(n){var u=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],p=["","拾","佰","仟"],w=["","万","亿","兆"],b=["角","分","毫","厘"],s="整",h="元",f,r,i="",c,e,l,y,t,o;if(n==""||(n=parseFloat(n),n>=1e15))return"";if(n==0)return u[0]+h+s;if(n=n.toString(),n.indexOf(".")==-1?(f=n,r=""):(c=n.split("."),f=c[0],r=c[1].substr(0,4)),parseInt(f,10)>0){for(e=0,l=f.length,t=0;t<l;t++){var o=f.substr(t,1),a=l-t-1,k=a/4,v=a%4;o=="0"?e++:(e>0&&(i+=u[0]),e=0,i+=u[parseInt(o)]+p[v]);v==0&&e<4&&(i+=w[k])}i+=h}if(r!="")for(y=r.length,t=0;t<y;t++)o=r.substr(t,1),o!="0"&&(i+=u[Number(o)]+b[t]);return i==""?i+=u[0]+h+s:r==""&&(i+=s),i}function deepCompare(){function u(n,r){var f;if(isNaN(n)&&isNaN(r)&&typeof n=="number"&&typeof r=="number"||n===r)return!0;if(typeof n=="function"&&typeof r=="function"||n instanceof Date&&r instanceof Date||n instanceof RegExp&&r instanceof RegExp||n instanceof String&&r instanceof String||n instanceof Number&&r instanceof Number)return n.toString()===r.toString();if(!(n instanceof Object&&r instanceof Object)||n.isPrototypeOf(r)||r.isPrototypeOf(n)||n.constructor!==r.constructor||n.prototype!==r.prototype||t.indexOf(n)>-1||i.indexOf(r)>-1)return!1;for(f in r)if(r.hasOwnProperty(f)!==n.hasOwnProperty(f)||typeof r[f]!=typeof n[f])return!1;for(f in n){if(r.hasOwnProperty(f)!==n.hasOwnProperty(f)||typeof r[f]!=typeof n[f])return!1;switch(typeof n[f]){case"object":case"function":if(t.push(n),i.push(r),!u(n[f],r[f]))return!1;t.pop();i.pop();break;default:if(n[f]!==r[f])return!1}}return!0}var n,r,t,i;if(arguments.length<1)return!0;for(n=1,r=arguments.length;n<r;n++)if(t=[],i=[],!u(arguments[0],arguments[n]))return!1;return!0}function getClass(n){return Object.prototype.toString.call(n).slice(8,-1)}function deepCopy(n){var i,u=getClass(n),r,t;if(u=="Object")i={};else if(u=="Array")i=[];else return n;for(r in n)t=n[r],i[r]=getClass(t)=="Object"?deepCopy(t):getClass(t)=="Array"?deepCopy(t):t;return i}function myPromise(n,t=undefined,i=1,r=undefined){const u={opType:n};return t&&(u.opData=JSON.stringify(t)),new Promise(n=>{ajaxPost("/Relay/Post",u,t=>{let u=t.errmsg;if(t.errno==0)r!=undefined&&r(),n(t);else if(t.datas&&t.datas.length>0){let n="";n=t.datas.join();n+=",";u=n+u}if(t.errno!=0&&u||i!==0)return layer.msg(u)},i)})}function dataTableConfig(n=0,t=false,i=true,r=0,u=true){const o=[{data:null,title:"",render:tableDefault().isEnable,orderable:!1,sWidth:"auto",visible:i}],e=[{data:"XvHao",title:"序号",sWidth:"25px",sClass:"xvhao"}],s=[{data:null,title:"全选<input type='checkbox' class='icb_minimal' id='checkAll'>",render:()=>`<input type="checkbox" class="icb_minimal isEnable">`,orderable:!1}],f={dom:'<"pull-left"l><"pull-right"f>rt<"col-sm-5"i><"col-sm-7"p>',bAutoWidth:!t||!i,destroy:!0,paging:!0,searching:!0,ordering:u,aaSorting:[[r===0&&t?1:r,"asc"]],aLengthMenu:[25,50,75],iDisplayLength:25,language:oLanguage};return n!==0&&(addOrderData(n),f.data=n),t&&(!f.columns&&(f.columns=[]),f.columns=f.columns.concat(o)),f.addColumns=function(n,t=true){f.columns||(f.columns=[]);t&&!~f.columns.indexOf(e)&&(f.columns=f.columns.concat(e));f.columns=f.columns.concat(n)},f.modifyColumns=function(n,i=true){f.columns=[];t&&(f.columns=f.columns.concat(o));i&&(f.columns=f.columns.concat(e));f.columns=f.columns.concat(n)},f.clearColumns=function(n=false){f.columns=[];n||(f.columns=f.columns.concat(e))},f.fixedHeaderColumn=function(n,t=-1,i=-1,r="100%",u="600px"){f.ordering=!1;fixedHeaderColumn(f,n,t,i,r,u)},f.updateData=function(n){addOrderData(n);f.data=n},f}function fixedHeaderColumn(n,t,i=-1,r=-1,u="100%",f="600px"){return n.fixedHeader=t,n.scrollX=u,n.scrollY=f,n.scrollCollapse=!0,n.fixedColumns={leftColumns:i,rightColumns:r},n}function disabledOption(n,t,i=true){if(t)n.find(`option[value='${t}']`).prop("disabled",i);else{const t=[];if(n.find("option").prop("disabled",!1),n.each((n,i)=>{const r=$(i).val();r&&(t[r]=1)}),!t.length)return;Object.keys(t).forEach(t=>{n.find(`option[value='${t}']`).prop("disabled",!0)})}n.select2()}function updateDataTableTrSelect(n,t,i){const r=$(n).find(`.${t}`);r.find("option").prop("disabled",!1);const u=[];r.each((n,t)=>{const i=$(t).val();u[n]=i?i:0});$(r).html(i);u.length&&u.forEach((n,t)=>{$(r[t]).val(n).trigger("change")});Object.values(u).forEach(n=>{r.find(`option[value='${n}']`).prop("disabled",!0)})}function tableDefault(){return{order:(n,t,i,r)=>+r.row+1,isEnable:n=>`<input type="checkbox" class="icb_minimal isEnable" value="${n.Id}">`,span:(n,t)=>`<span class="textOn ${n}">${t}</span>`,input:(n,t)=>`<span class="textOn">${t}</span><input type="text" class="form-control text-center textIn ${n} hidden" maxlength="20" style="min-width:120px;width:${n==="remark"?"100%":"auto"}" value=${t}>`,addInput:(n,t,i)=>`<input type="text" class="form-control text-center ${n}" style="margin:auto;min-width:70px;width:${t}" value="${i}">`,emptyInput:(n,t,i)=>{i==undefined&&t!=undefined&&(i=t);t==undefined&&(t="");var r=t.split(",");return`<span class="textOn"></span>
                        <input type="text" class="form-control text-center textIn ${n} hidden" 
                            maxlength="20" style="min-width:${r[0]||80}px;width:${r[1]||80}px;" value=${i}>`},numberInput:(n,t,i)=>{var r=t.split(",");return`<span class="textOn">${r[5]?"":i}</span><input type="text" class="form-control text-center textIn ${n} hidden" 
                        oninput="onInput(this, ${r[1]||5}, ${r[2]||0}, ${r[3]||undefined}, ${r[4]||undefined})" 
                            style="margin:auto;min-width:70px;width:${r[0]}" value="${i}">`},addNumberInput:(n,t,i)=>{var r=t.split(",");return`<input type="text" class="form-control text-center ${n}" oninput="onInput(this, ${r[1]||5}, ${r[2]||0})" style="margin:auto;min-width:70px;width:${r[0]}" value="${i}">`},select:(n,t,i)=>`<span class="textOn">${i}</span><select class="form-control mSelect hidden textIn ${t}" style="min-width:120px;">${n}</select>`,addSelect:(n,t)=>`<select class="form-control mSelect ${t}" style="min-width:120px">${n}</select>`,updateBtn:(n,t)=>`<button class="btn btn-success btn-xs" onclick="${n}.call(this)" value="${t}">修改</button>`,delBtn:()=>`<button class="btn btn-danger btn-xs" onclick="delDataTableTr.call(this)"><i class="fa fa-minus"></i></button>`,addBtn:n=>`<button class="btn btn-success btn-xs" onclick="${n}.call(this)"><i class="fa fa-plus"></i></button>`,setBtn:()=>'<button class="btn btn-primary btn-sm set-btn">设置<\/button>',detailBtn:(n,t)=>`<button class="btn btn-info btn-sm" onclick="${n}.call(this, ${t})" value="${t}">查看</button>`,processDetail:n=>n.replace(/,/g," > "),text:(n,t,i=null)=>t.length>(i?i:tdShowLength)?`<span title="${t}" onclick = "showAllContent('${escape(t)}', '${n}')">${t.substring(0,i?i:tdShowLength)}...</span>`:`<span title="${t}" class="chose1">${t}</span>`,isRework:()=>'<select class="form-control mSelect isRework" style="width:100px"><option value="0">否<\/option><option value="1">是<\/option><\/select>',isReworkText:n=>n?"是":"否",day:(n,t)=>`<span class="textOn">${t.split(" ")[0]}</span><input type="text" class="pointer textIn hidden form_date form-control text-center ${n}" style="min-width: 100px">`,addDay:(n,t)=>`<input type="text" class="pointer form_date form-control text-center ${n}" value="${t?t.split(" ")[0]:""}" style="min-width: 100px">`,state:n=>{return`<span style="color:${["#CCCCCC","#ff9933","#ff33cc","black","black","#FF0000"][n.State]}">${n.StateStr}</span>`},delivery:n=>{let t="black";return new Date(n)-new Date(getFullTime())<2592e5&&(t="red"),`<span style="color:${t}">${n.split(" ")[0]}</span>`},progress:n=>`${n}%`,endFinishTime:n=>n.State===4?n.EndTime:tableDefault().state(n),stateOps:'<option value="1">正常<\/option><option value="2">休息<\/option>',DevStateOps:'<option value="1">正常<\/option><option value="2">故障<\/option><option value="3">报废<\/option>',isFinish:n=>{let t="remove",i="red";return n.Id&&(t="ok",i="green"),`<span class="glyphicon glyphicon-${t} text-${i} middle" aria-hidden="true" style="font-size:25px"></span>`},isChose:n=>{let t="remove",i="red";return n&&(t="ok",i="green"),`<span class="glyphicon glyphicon-${t} text-${i} middle" aria-hidden="true" style="font-size:25px"></span>`},hms:n=>`<div class="flexStyle" style="justify-content:center">
                        <input type="text" class="form-control text-center hour" style="width:60px" oninput="onInput(this, 5, 0)" value="${n.Hour||0}"><span style="margin:0 5px">时</span>
                        <input type="text" class="form-control text-center minute" style="width:40px" oninput="onTimeLimitInput(this)" value="${n.Min||0}"><span style="margin:0 5px">分</span>
                        <input type="text" class="form-control text-center second" style="width:40px" oninput="onTimeLimitInput(this)" value="${n.Sec||0}"><span style="margin:0 5px">秒</span>
                    </div>`,hmsCal:n=>{var t=convertTime(n);return`<div class="flexStyle" style="justify-content:center">
                        <input type="text" class="form-control text-center hour" style="width:60px" oninput="onInput(this, 5, 0)" value="${t.h}"><span style="margin:0 5px">时</span>
                        <input type="text" class="form-control text-center minute" style="width:40px" oninput="onTimeLimitInput(this)" value="${t.m||0}"><span style="margin:0 5px">分</span>
                        <input type="text" class="form-control text-center second" style="width:40px" oninput="onTimeLimitInput(this)" value="${t.s||0}"><span style="margin:0 5px">秒</span>
                    </div>`},msCal:(n,t,i)=>{var r=convertTime(i,!1);return t?`${r.m}<span style="margin:0 5px">分</span>${r.s}<span style="margin:0 5px">秒</span>`:`<div class="flexStyle" style="justify-content:center">
                        <input type="text" class="form-control text-center minute ${n}" oninput="onInput(this, 5, 0)" style="width:60px" value="${r.m}"><span style="margin:0 5px">分</span>
                        <input type="text" class="form-control text-center second ${n}" oninput="onTimeLimitInput(this)" style="width:40px" value="${r.s}"><span style="margin:0 5px">秒</span>
                    </div>`},showTime:n=>n==="0001-01-01 00:00:00"?"":n.split(" ")[0]}}function addDataTableTr(n,t){t.XvHao=$(n).DataTable().rows()[0].length+1;const i=$(n).DataTable();i.row.add(t).draw(!1);i.column(0).nodes().each((n,t)=>{$(n).text(t+1)})}function delDataTableTr(){const n=$(this).parents("tr")[0],i=$(n).parents("table").prop("id"),t=$(`#${i}`).DataTable();t.rows(n).remove().draw(!1);t.column(0).nodes().each((n,t)=>{$(n).text(t+1)})}function getDataTableRow(n){return $(n).DataTable().rows().nodes()}function initCheckboxAddEvent(n,t,i,r=true,u="Changed"){const f=this.api();if($(this).find(".isEnable").iCheck({handle:"checkbox",checkboxClass:"icheckbox_minimal-blue",increaseArea:"20%"}),u=="Changed")$(this).find(".isEnable").off("ifChanged").on("ifChanged",function(){const r=$(this).parents("tr"),u=r[0];$(this).is(":checked")?(n.push(u),t&&(t(r,f.row(u).data()),r.find(".textOn").addClass("hidden").siblings(".textIn").removeClass("hidden"))):(n.splice(n.indexOf(u),1),t&&r.find(".textIn").addClass("hidden").siblings(".textOn").removeClass("hidden"),i&&i(r,f.row(u).data()))});else if(u=="Checked")$(this).find(".isEnable").off("ifChecked").on("ifChecked",function(){const r=$(this).parents("tr"),u=r[0];$(this).is(":checked")?(n.push(u),t&&(t(r,f.row(u).data()),r.find(".textOn").addClass("hidden").siblings(".textIn").removeClass("hidden"))):(n.splice(n.indexOf(u),1),t&&r.find(".textIn").addClass("hidden").siblings(".textOn").removeClass("hidden"),i&&i(r,f.row(u).data()))}).off("ifUnchecked").on("ifUnchecked",function(){const r=$(this).parents("tr"),u=r[0];$(this).is(":checked")?(n.push(u),t&&(t(r,f.row(u).data()),r.find(".textOn").addClass("hidden").siblings(".textIn").removeClass("hidden"))):(n.splice(n.indexOf(u),1),t&&r.find(".textIn").addClass("hidden").siblings(".textOn").removeClass("hidden"),i&&i(r,f.row(u).data()))});r&&$(this).find(".isEnable").iCheck("uncheck")}function initCheckboxAddCheckedEvent(n,t,i,r=true){const u=this.api();$(this).find(".isEnable").iCheck({handle:"checkbox",checkboxClass:"icheckbox_minimal-blue",increaseArea:"20%"}).off("ifChecked").on("ifChecked",function(){const r=$(this).parents("tr"),f=r[0];$(this).is(":checked")?(n.push(f),t&&(t(r,u.row(f).data()),r.find(".textOn").addClass("hidden").siblings(".textIn").removeClass("hidden"))):(n.splice(n.indexOf(f),1),t&&r.find(".textIn").addClass("hidden").siblings(".textOn").removeClass("hidden"),i&&i(r,u.row(f).data()))});r&&$(this).find(".isEnable").iCheck("uncheck")}function disabledTableCheck(n,t=[]){$(`#${n}`).find(".isEnable").iCheck("disable");t.length>0&&t.forEach(t=>{$(`#${n}`).find(`.isEnable[value=${t}]`).iCheck("enable")})}function enableTableCheck(n,t=[]){$(`#${n}`).find(".isEnable").iCheck("enable");t.length>0&&t.forEach(t=>{$(`#${n}`).find(`.isEnable[value=${t}]`).iCheck("disable")})}function initInputChangeEvent(n){const t=this.api();$(this).find(".textIn").off("change").on("change",function(){const i=$(this).parents("tr"),r=i[0];n&&n(i,t.row(r).data())})}function delTableRow(n,t,i){if(!n||!n.length)return layer.msg("请选择需要删除的数据");const r=[];n.forEach(n=>{const t=$(n);r.push(t.find(".isEnable").val()>>0)});showConfirm("删除所选项",()=>myPromise(t,{ids:r}).then(i))}function addTableRow(n,t,i,r){const f=[],u=getDataTableRow(n);if(!u||!u.length){layer.msg("请先设置数据再添加");return}for(let n=0,i=u.length;n<i;n++){const i=t($(u[n]),!0);if(!i)return;f.push(i)}myPromise(i,f).then(r)}function updateTableRow(n,t,i,r){if(!n||!n.length){layer.msg("请选择需要修改的数据");return}const u=[];for(let i=0,r=n.length;i<r;i++){const r=t($(n[i]),!1);if(!r)return;u.push(r)}myPromise(i,u).then(r)}function initDayTime(n,t=undefined,i=undefined){$(n).find(".form_date").attr("readonly",!0).datepicker({language:"zh-CN",format:"yyyy-mm-dd",maxViewMode:2,todayBtn:"linked",autoclose:!0}).on("changeDate",function(){isStrEmptyOrUndefined($(this).val())&&t&&$(this).val(getDate(t)).datepicker("update");i&&i()})}function addOrderData(n){for(let t=0;t<n.length;t++)n[t].XvHao=t+1;return n}function updateTable(n,t){var i,f,e;addOrderData(t);const r=t.length;if(r==0){n.clear().draw();return}const u=n.data().length,s=n.data().splice(0,u),h=r>u?u:r;const o=[];for(i=0;i<h;i++){const r=s[i];if(f=t[i],!deepCompare(r,f)){for(e in r)r.hasOwnProperty(e)&&f.hasOwnProperty(e)&&(n.data()[i][e]=f[e]);o.push(i)}}if(n.rows(o).invalidate().draw(),r<u){const t=[];for(i=u-1;i>=r;i--)t.push(i);n.rows(t).remove().draw()}else{const e=[];for(i=u;i<r;i++)f=t[i],e.push(f);n.rows.add(e).draw()}}function sortOrder(n,t,i=0){return n.hasOwnProperty("Order")?i==0?n.Order-t.Order:t.Order-n.Order:i==0?n.order-t.order:t.order-n.order}function getScrollTable(n,t){const i=t&&t.length>0?t.reduce((n,t)=>`${n}<th>${t}</th>`,""):"";return`<div class="tablebox">
            <div class="tbl-header">
                <table border="0" cellspacing="0" cellpadding="0">
                    <thead>
                        <tr>
                            ${i}
                        </tr>
                    </thead>
                    <tbody style="opacity:0;"></tbody>
                </table>
            </div>
            
            <div class="tbl-body">
                <table border="0" cellspacing="0" cellpadding="0" id="${n}">
                    <thead>
                        <tr>
                            ${i}
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>`}function getTable(n,t,i=0){const r=t&&t.length>0?t.reduce((n,t)=>`${n}<th style='width:${t.width?`${t.width}px`:"auto"}'>${t}</th>`,""):"";return`<div class="kb_item_tablebox">
        <table border="${i}" cellspacing="0" cellpadding="0" id="${n}">
            <thead>
                <tr>
                    ${r}
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        </div>`}function getTableW(n,t,i=0){const r=t&&t.length>0?t.reduce((n,t)=>`${n}<th style='width:${t.width&&t.width!=="auto"?`${t.width}px`:"auto"}'>${t.title}</th>`,""):"";return`<div class="kb_item_tablebox">
            <table border="${i}" cellspacing="0" cellpadding="0" id="${n}" style="table-layout:fixed;">
                <thead>
                    <tr>
                        ${r}
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>`}function autoScroll(n){const t=$(`#${n} tbody`),i=t.find("tr:first").height();t.animate({marginTop:-i+"px"},1e3,()=>{t.css({margin:0}).find("tr:first").appendTo(t)})}function scrollTable(n,t,i){clearInterval(n[t]);const r=$(`#${i}`);r.hover(()=>{clearInterval(n[t])},()=>{n[t]=setInterval(()=>{autoScroll(i)},2e3)}).trigger("mouseleave")}function stopScrollTable(n,t,i){$(`#${i}`).unbind("mouseenter mouseleave");clearInterval(n[t]);delete n[t]}function showPermissions(n,t){var s=`<div class="box box-solid noShadow" style="margin-bottom: 0;">
                            <div class="box-header no-padding">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="on_i fa fa-minus"></i></button>
                                <label class="pointer" style="margin:0;font-weight:inherit">
                                    <input type="checkbox" class="on_cb" style="width: 15px" value="0">
                                    <span class="textOverTop" style="vertical-align: middle;font-size: 16px">权限管理</span>
                                </label>
                            </div>
                            <div class="box-body no-padding">
                                <ul class="on_ul nav nav-pills nav-stacked mli" style="margin-left: 20px">{0}</ul>
                            </div>
                        </div>`,h=`<li><div class="box box-solid noShadow collapsed-box" style="margin-bottom: 0;">
                        <div class="box-header no-padding">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="on_i fa fa-plus"></i></button>
                            <label class="pointer" style="margin:0;font-weight:inherit">
                                <input type="checkbox" class="on_cb" style="width: 15px" value="{0}">
                                <span class="textOverTop" style="vertical-align: middle;font-size: 16px">{1}</span>
                            </label>
                        </div>
                        <div class="box-body no-padding">
                            <ul class="on_ul nav nav-pills nav-stacked mli" style="margin-left: 20px">{2}</ul>
                        </div>
                    </div></li>`,c=`<li><div class="box box-solid noShadow" style="margin-bottom: 0;">
                            <div class="box-header no-padding">
                                <a type="button" class="btn btn-box-tool disabled" data-widget="collapse"><i class="fa fa-chevron-right"></i></a>
                                <label class="pointer" style="margin:0;font-weight:inherit">
                                    <input type="checkbox" class="on_cb" style="width: 15px" value="{0}">
                                    <span class="textOverTop" style="vertical-align: middle;font-size: 16px">{1}</span>
                                </label>
                            </div>
                        </div></li>`,i,f,o,r,u,e;for(t.sort((n,t)=>n.order-t.order),i={parent:[]},f=0,o=t.length;f<o;f++)r=t[f],u=r.Parent,u==0?i.parent.push(r):i[u]?i[u].push(r):i[u]=[r];e=n=>n.map(n=>{return""+(i[n.Id]?h.format(n.Id,n.Name,e(i[n.Id])):c.format(n.Id,n.Name))}).join("");$(`#${n}`).empty().append(i.parent.length?s.format(e(i.parent)):"");$(".on_cb").iCheck({checkboxClass:"icheckbox_minimal",increaseArea:"20%"})}function getListNoCover(n,t=null,i=0,r=true,u=0){n&&n(null,!1,t,u,r,i)}function getMenuNoCover(n,t=null,i=0,r=false,u=0){n&&n(null,!0,t,u,r,i)}var isCover=!1,prepareUpload,floatObj,decimalObj;String.prototype.format=function(n){var i=this,r,t,u;if(arguments.length>0)if(arguments.length==1&&typeof n=="object")for(r in n)n[r]!=undefined&&(u=new RegExp("({"+r+"})","g"),i=i.replace(u,n[r]));else for(t=0;t<arguments.length;t++)arguments[t]!=undefined&&(u=new RegExp("({)"+t+"(})","g"),i=i.replace(u,arguments[t]));return i};String.format=function(){var t,n,i;if(arguments.length==0)return null;for(t=arguments[0],n=1;n<arguments.length;n++)i=new RegExp("\\{"+(n-1)+"\\}","gm"),t=t.replace(i,arguments[n]);return t};ImgCreated.prototype.dataType=dataType;ImgCreated.prototype.create=create;prepareUpload=[];Array.prototype.selectMany=function(n){return this.map(n).reduce(function(n,t){return n.concat(t)})};floatObj=function(){function i(n){return Math.floor(n)===n}function t(n){var t={times:1,num:0};if(i(n))return t.num=n,t;var r=n+"",f=r.indexOf("."),e=r.substr(f+1).length,u=Math.pow(10,e),o=parseInt(n*u+.5,10);return t.times=u,t.num=o,t}function n(n,i,r){var h=t(n),c=t(i),e=h.num,o=c.num,u=h.times,f=c.times,l=u>f?u:f,s=null;switch(r){case"add":return s=u===f?e+o:u>f?e+o*(u/f):e*(f/u)+o,s/l;case"subtract":return s=u===f?e-o:u>f?e-o*(u/f):e*(f/u)-o,s/l;case"multiply":return e*o/(u*f);case"divide":return e/o*(f/u)}}function r(t,i){return n(t,i,"add")}function u(t,i){return n(t,i,"subtract")}function f(t,i){return n(t,i,"multiply")}function e(t,i){return n(t,i,"divide")}return{add:r,subtract:u,multiply:f,divide:e}}();decimalObj=function(){function n(n,t,i){switch(i){case"add":return new Decimal(n).add(new Decimal(t)).toNumber();case"subtract":return new Decimal(n).sub(new Decimal(t)).toNumber();case"multiply":return new Decimal(n).mul(new Decimal(t)).toNumber();case"divide":return new Decimal(n).div(new Decimal(t)).toNumber()}}function t(t,i){return n(t,i,"add")}function i(t,i){return n(t,i,"subtract")}function r(t,i){return n(t,i,"multiply")}function u(t,i){return n(t,i,"divide")}return{add:t,subtract:i,multiply:r,divide:u}}();