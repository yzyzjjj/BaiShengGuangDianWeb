@model object

@{
    ViewBag.Title = "维修管理";
    Layout = "_Layout";
}

<script src="~/mjs/RepairManagement/index.js"></script>

<section class="content ">
    <h2 class="text-center">
        维修管理
        <button type="button" class="btn btn-primary pull-right btn-sm" style="margin-left: 10px" onclick="getUsuallyFaultList()">常见故障解决</button>
        <button type="button" class="btn btn-primary pull-right btn-sm" onclick="getFaultTypeList()">故障类型</button>
    </h2>
    <div class="row">
        <div class="nav-tabs-custom">
            <ul class="nav nav-tabs ui-sortable-handle">
                <li class="active"><a href="#faultDevice" data-toggle="tab" aria-expanded="true">故障设备</a></li>
                <li><a href="#delFaultDevice" data-toggle="tab" aria-expanded="false">已删除故障设备</a></li>
            </ul>
            <div class="tab-content no-padding">
                <div class="tab-pane active in" id="faultDevice">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">故障设备</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-primary btn-sm" onclick="getFaultDeviceList()">重新加载</button>
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="table-responsive mailbox-messages">
                                <table class="table table-hover table-striped" id="faultDeviceList"></table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade in" id="delFaultDevice">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">已删除故障设备</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="form-group form-inline">
                                <label class="control-label">查询方式：</label>
                                <div class="fHead" style="display: -webkit-inline-box">
                                    <label style="margin-left: 5px;cursor:pointer"><input type="checkbox" class="icb_minimal" checked="checked"><span style="margin-left: 5px">时间范围查询</span></label>
                                </div>
                            </div>
                            <div class="form-group form-inline">
                                <div class="form-group form-inline" id="fTime">
                                    <div class="form-group">
                                        <label class="control-label" for="fStartDate">开始时间：</label>
                                        <div class="form-group no-margin" style="display: -webkit-inline-box">
                                            <input type="text" id="fStartDate" class="form_date form-control" style="width: 130px;cursor:pointer">
                                            <span>&nbsp;-&nbsp;</span>
                                            <input type="text" id="fStartTime" class="form_time form-control" style="width: 100px;cursor:pointer">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label" for="fEndDate">结束时间：</label>
                                        <div class="form-group no-margin" style="display: -webkit-inline-box">
                                            <input type="text" id="fEndDate" class="form_date form-control" style="width: 130px;cursor:pointer">
                                            <span>&nbsp;-&nbsp;</span>
                                            <input type="text" id="fEndTime" class="form_time form-control" style="width: 100px;cursor:pointer">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label hidden" id="fBtn">所有内容：</label>
                                    <button type="button" class="btn btn-primary" onclick="getDelFaultDeviceList()" style="margin-left: 4px">查询</button>
                                </div>
                            </div>
                            <div class="table-responsive mailbox-messages">
                                <table class="table table-hover table-striped" id="delFaultDeviceList"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="nav-tabs-custom">
            <ul class="nav nav-tabs ui-sortable-handle">
                <li class="active"><a href="#repairList" data-toggle="tab" aria-expanded="true">维修记录</a></li>
                <li><a href="#delRepair" data-toggle="tab" aria-expanded="false">已删除维修记录</a></li>
            </ul>
            <div class="tab-content no-padding">
                <div class="tab-pane active in" id="repairList">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">维修记录</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-primary btn-sm" id="rChange" onclick="rChange(0, 1)">添加纪录</button>
                                <button type="button" class="btn btn-primary btn-sm" onclick="getRepairRecordList()">重新加载</button>
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="table-responsive mailbox-messages">
                                <table class="table table-hover table-striped" id="repairRecordList"></table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade in" id="delRepair">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">已删除维修记录</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="form-group form-inline">
                                <label class="control-label">查询方式：</label>
                                <div class="rHead" style="display: -webkit-inline-box">
                                    <label style="margin-left: 5px;cursor:pointer"><input type="checkbox" class="icb_minimal" checked="checked"><span style="margin-left: 5px">时间范围查询</span></label>
                                </div>
                            </div>
                            <div class="form-group form-inline">
                                <div class="form-group form-inline" id="rTime">
                                    <div class="form-group">
                                        <label class="control-label" for="rStartDate">开始时间：</label>
                                        <div class="form-group no-margin" style="display: -webkit-inline-box">
                                            <input type="text" id="rStartDate" class="form_date form-control" style="width: 130px;cursor:pointer">
                                            <span>&nbsp;-&nbsp;</span>
                                            <input type="text" id="rStartTime" class="form_time form-control" style="width: 100px;cursor:pointer">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label" for="rEndDate">结束时间：</label>
                                        <div class="form-group no-margin" style="display: -webkit-inline-box">
                                            <input type="text" id="rEndDate" class="form_date form-control" style="width: 130px;cursor:pointer">
                                            <span>&nbsp;-&nbsp;</span>
                                            <input type="text" id="rEndTime" class="form_time form-control" style="width: 100px;cursor:pointer">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label hidden" id="rBtn">所有内容：</label>
                                    <button type="button" class="btn btn-primary" onclick="getDelRepairList()" style="margin-left: 4px">查询</button>
                                </div>
                            </div>
                            <div class="table-responsive mailbox-messages">
                                <table class="table table-hover table-striped" id="delRepairList"></table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="singleFaultModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">故障设备操作</h4>
                    <label class="hidden" id="singleUpdateId"></label>
                    <label class="hidden" id="singleUpdateState"></label>
                    <label class="hidden" id="singleUpdateCodeId"></label>
                </div>
                <div class="modal-body">
                    <div class="form-group form-inline">
                        <label class="control-label" for="singleFaultCode">机台号：</label>
                        <input class="dd form-control" disabled="disabled" id="singleFaultCode">
                        <div class="hidden" id="rFaultCodeDiv">
                            <select class="form-control" style="width: 80%" id="rFaultCode" onchange="focusIn($(this))"></select>
                        </div>
                    </div>
                    <div class="form-group" id="faultOtherDiv">
                        <div class="form-group form-inline">
                            <label class="control-label" for="faultOther">其他机台号：</label>
                            <input type="text" class="form-control" id="faultOther" placeholder="请输入" maxlength="20">
                        </div>
                    </div>
                    <div class="form-group form-inline">
                        <label class="control-label" for="singleProposer">报修人：</label>
                        <input class="dd form-control" disabled="disabled" id="singleProposer" maxlength="20">
                        <label class="adt label-danger hidden" id="singleProposerTip"></label>
                    </div>
                    <div class="form-group form-inline">
                        <label class="control-label" for="singleFaultDate">故障时间：</label>
                        <span>
                            <input type="text" id="singleFaultDate" disabled="disabled" class="dd form_date form-control" style="cursor: pointer">
                        </span>
                        <span>
                            <input type="text" id="singleFaultTime" disabled="disabled" class="dd form_time form-control" style="cursor: pointer">
                        </span>
                    </div>
                    <div class="form-group">
                        <label class="control-label" for="singleFaultType1">故障类型：</label>
                        <select class="dd ms2 form-control" style="width: 88%" id="singleFaultType1"></select>
                    </div>
                    <div class="form-group">
                        <label class="control-label" for="singleFaultDefaultDesc">故障类型描述：</label>
                        <textarea class="form-control" id="singleFaultDefaultDesc" disabled="disabled" style="resize: vertical; height: 100px; overflow-y: scroll;" maxlength="1000"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="control-label" for="singleFaultDesc">补充：</label>
                        <textarea class="dd form-control" disabled="disabled" id="singleFaultDesc" style="resize: vertical; height: 100px; overflow-y: scroll;"></textarea>
                    </div>
                    <div class="form-group form-inline">
                        <label class="control-label" for="singleFaultPriority">优先级：</label>
                        <select class="dd form-control" id="singleFaultPriority" disabled="disabled">
                            <option value="0">低</option>
                            <option value="1">中</option>
                            <option value="2">高</option>
                        </select>
                    </div>

                    <div class="box hidden" id="solveDiv">
                        <div class="box-body">
                            <div class="form-group form-inline">
                                <label class="control-label" for="singleFaultSolver">解决人：</label>
                                <input class="form-control" id="singleFaultSolver" maxlength="20">
                                <label class="adt label-danger hidden" id="singleFaultSolverTip"></label>
                            </div>
                            <div class="form-group form-inline">
                                <label class="control-label" for="singleFaultDate">解决时间：</label>
                                <span>
                                    <input type="text" id="singleSolveDate" class="form_date form-control" style="cursor: pointer">
                                </span>
                                <span>
                                    <input type="text" id="singleSolveTime" class="form_time form-control" style="cursor: pointer">
                                </span>
                            </div>
                            <div class="form-group form-inline">
                                <label class="control-label" for="singleFaultType">故障类型：</label>
                                <select class="form-control" id="singleFaultType" style="width: 88%"></select>
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="singleSolvePlan">解决方案：</label>
                                <textarea class="form-control" id="singleSolvePlan" style="resize: vertical; height: 200px; overflow-y: scroll;" maxlength="1000"></textarea>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="db btn btn-primary hidden" onclick="singleChange(0)" id="singleChange">修改</button>
                    <button type="button" class="db btn btn-primary hidden" onclick="singleChange(1)" id="singleSure">确认故障</button>
                    <button type="button" class="db btn btn-primary hidden" onclick="singleChange(2)" id="singleRepairing">开始维修</button>
                    <button type="button" class="db btn btn-primary hidden" onclick="singleChange(3)" id="singleRepaired">维修完成</button>
                    <button type="button" class="db btn btn-primary hidden" onclick="recordChange(0)" id="recordChange">修改</button>
                    <button type="button" class="db btn btn-primary hidden" onclick="recordChange(1)" id="recordAdd">添加</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="usuallyFaultModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">常见故障及解决方法</h4>
                    <button type="button" class="btn btn-primary pull-right btn-sm" id="showAddUsuallyFaultModel" onclick="showAddUsuallyFaultModel()">添加常见故障</button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive mailbox-messages">
                        <table class="table table-hover table-striped" id="usuallyFaultList" style="padding-right: 10px;"></table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="usuallyFaultDetailModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">解决方法</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <textarea class="form-control" disabled="disabled" id="usuallyFaultDetail" style="resize: vertical; height: 200px; overflow-y: scroll;"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="addUsuallyFaultModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">常见故障及解决方法</h4>
                </div>
                <div class="modal-body">

                    <div class="form-group">
                        <label class="control-label" for="addUsuallyFaultDesc"><span class="text-red">* </span>常见故障：</label>
                        <input class="form-control" id="addUsuallyFaultDesc" onfocusin="focusIn($(this))" maxlength="20">
                        <label class="adt label-danger hidden" id="addUsuallyFaultDescTip"></label>
                    </div>
                    <div class="form-group">
                        <label class="control-label" for="addSolverPlan">解决方法：</label>
                        <textarea class="form-control" id="addSolverPlan" style="resize: vertical" onfocusin="focusIn($(this))" maxlength="1000"></textarea>
                        <label class="adt label-danger hidden" id="addSolverPlanTip"></label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="addUsuallyFault()">添加</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="updateUsuallyFaultModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">常见故障及解决方法</h4>
                    <label class="hidden" id="updateId"></label>
                </div>
                <div class="modal-body">
                    <div class="box">
                        <div class="box-body">
                            <div class="form-group">
                                <label class="control-label" for="updateUsuallyFaultDesc"><span class="text-red">* </span>常见故障：</label>
                                <input class="form-control" id="updateUsuallyFaultDesc" onfocusin="focusIn($(this))" maxlength="20">
                                <label class="adt label-danger hidden" id="updateUsuallyFaultDescTip"></label>
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="updateSolverPlan">解决方法：</label>
                                <textarea class="form-control" id="updateSolverPlan" style="resize: vertical; height: 200px; overflow-y: scroll;" onfocusin="focusIn($(this))" maxlength="1000"></textarea>
                                <label class="adt label-danger hidden" id="updateSolverPlanTip"></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="updateUsuallyFault()">修改</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="faultTypeModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">故障类型</h4>
                    <button type="button" id="showAddFaultTypeModel" class="btn btn-primary pull-right btn-sm" onclick="showAddFaultTypeModel()">添加故障类型</button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive mailbox-messages">
                        <table class="table table-hover table-striped" id="faultTypeList" style="padding-right: 10px;"></table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="faultTypeDetailModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">故障描述</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="control-label" for="faultTypeDetail">故障类型描述：</label>
                        <textarea class="form-control" disabled="disabled" id="faultTypeDetail" style="resize: vertical; height: 100px; overflow-y: scroll;"></textarea>
                    </div>
                    <div class="form-group hidden" id="faultTypeDetail1Div">
                        <label class="control-label" for="faultTypeDetail1">补充：</label>
                        <textarea class="form-control" disabled="disabled" id="faultTypeDetail1" style="resize: vertical; height: 100px; overflow-y: scroll;"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="addFaultTypeModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">故障类型</h4>
                </div>
                <div class="modal-body">

                    <div class="form-group">
                        <label class="control-label" for="addFaultTypeName"><span class="text-red">* </span>故障类型：</label>
                        <input class="form-control" id="addFaultTypeName" onfocusin="focusIn($(this))" maxlength="20">
                        <label class="adt label-danger hidden" id="addFaultTypeNameTip"></label>
                    </div>
                    <div class="form-group">
                        <label class="control-label" for="addFaultTypeDesc">故障类型描述：</label>
                        <textarea class="form-control" id="addFaultTypeDesc" style="resize: vertical" onfocusin="focusIn($(this))" maxlength="1000"></textarea>
                        <label class="adt label-danger hidden" id="addFaultTypeDescTip"></label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="addFaultType()">添加</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态框（Modal） -->
    <div class="modal fade" tabindex="-1" id="updateFaultTypeModel" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title">故障类型</h4>
                    <label class="hidden" id="updateTypeId"></label>
                </div>
                <div class="modal-body">
                    <div class="box">
                        <div class="box-body">
                            <div class="form-group">
                                <label class="control-label" for="updateFaultTypeName"><span class="text-red">* </span>故障类型：</label>
                                <input class="form-control" id="updateFaultTypeName" onfocusin="focusIn($(this))" maxlength="20">
                                <label class="adt label-danger hidden" id="updateFaultTypeNameTip"></label>
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="updateFaultTypeDesc">故障类型描述：</label>
                                <textarea class="form-control" id="updateFaultTypeDesc" style="resize: vertical; height: 200px; overflow-y: scroll;" onfocusin="focusIn($(this))" maxlength="1000"></textarea>
                                <label class="adt label-danger hidden" id="updateFaultTypeDescTip"></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="updateFaultType()">修改</button>
                </div>
            </div>
        </div>
    </div>
</section>
